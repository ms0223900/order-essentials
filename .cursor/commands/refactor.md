請先分析以下項目，找出可以改進的地方：
1. 程式碼氣味：找出重複程式碼、過長的函數、過大的類別、魔法數字等問題
2. 可抽象化的模組：識別可以提取成共用函數或模組的重複邏輯
3. 可文件化的知識：找出需要補充說明的地方，包含複雜演算法、特殊業務邏輯、設計決策原因等
4. 可維護性問題：識別過度耦合、難以測試、難以擴展的部分
5. 效能優化機會：找出可能的效能瓶頸或優化空間

請以結構化的方式列出建議，每個建議都要包含：
- 問題描述
- 影響範圍
- 改進優先級（高、中、低）
- 預期效益

接著，請為優先級「高」的項目（或前 3 個優先級最高的項目），生成詳細的重構步驟。每個重構項目都要包含：
1. 重構目標：明確說明這次重構要達成什麼目標
2. 重構步驟：將重構拆解成多個小步驟，每個步驟都要：
   - 說明要做什麼
   - 列出需要修改的檔案
   - 提供驗證方法
   - 標註可能的風險
3. 測試策略：說明重構後如何驗證功能沒有被破壞
4. 回滾方案：如果重構失敗，如何快速回滾到原始狀態

請確保每個步驟都可以獨立執行和驗證，避免一次性大幅修改。將重構步驟整理成 markdown 格式，並放在 `docs/refactoring` 目錄下，檔名為 `refactoring-<重構目標>.md`。